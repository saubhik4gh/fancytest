name: Create PR for synced directory

on:
  workflow_dispatch:
    inputs:
      sync_branch:
        description: "Existing branch with synced changes (e.g. sync-1877)"
        required: true
        type: string

jobs:
  create-pr:
    runs-on: ubuntu-latest

    permissions:
      contents: read
      pull-requests: write

    steps:
      - name: Validate branch exists
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          echo "Checking branch: ${{ inputs.sync_branch }}"
          gh api repos/saubhik4gh/fancytest/branches/${{ inputs.sync_branch }} \
            >/dev/null || { echo "âŒ Branch does not exist"; exit 1; }

      - name: Create Pull Request
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          gh pr create \
            --repo saubhik4gh/fancytest \
            --head saubhik4gh:${{ inputs.sync_branch }} \
            --base main \
            --title "Sync cloud release logs" \
            --body "ğŸ”„ Manual PR creation for already-synced changes"
